# 贈る言葉BOT 要件定義書

## 概要

友達同士でオリジナルの言葉とその意味を贈り合うWebアプリケーション。武田鉄矢が黒板の前で言葉を贈ってくれる画像を生成し、共有リンクとして送ることができる。

**プロジェクト種別**: Webアプリケーション（静的サイト）
**対象ユーザー**: 友達同士、感謝や応援のメッセージを送りたい人
**技術スタック**: React 18.3+ + TypeScript 5.0+ + Vite 5.x
**デプロイ先**: GitHub Pages

## 関連文書

- **ユーザストーリー**: [📖 gift-words-user-stories.md](gift-words-user-stories.md)
- **受け入れ基準**: [✅ gift-words-acceptance-criteria.md](gift-words-acceptance-criteria.md)

## 機能要件（EARS記法）

**【信頼性レベル凡例】**:
- 🔵 **青信号**: EARS要件定義書・設計文書・ユーザヒアリングを参考にした確実な要件
- 🟡 **黄信号**: EARS要件定義書・設計文書・ユーザヒアリングから妥当な推測による要件
- 🔴 **赤信号**: EARS要件定義書・設計文書・ユーザヒアリングにない推測による要件

### F-001: 言葉入力フォーム

#### 通常要件

- REQ-001: システムは「贈りたい言葉」のテキスト入力欄を提供しなければならない 🔵 *requirements.md.pdf 第2.1章より*
- REQ-002: システムは「その意味」のテキスト入力欄（複数行）を提供しなければならない 🔵 *requirements.md.pdf 第2.1章より*
- REQ-003: システムは「送信」ボタンを提供しなければならない 🔵 *requirements.md.pdf 第2.1章より*
- REQ-004: システムは初回訪問時にチュートリアル（使い方説明）を表示しなければならない 🔵 *ユーザヒアリング2025-01-20より*

#### 条件付き要件

- REQ-011: 「贈りたい言葉」が空の場合、システムはインラインエラーメッセージを表示しなければならない 🟡 *requirements.md.pdf バリデーション要件 + ユーザヒアリングから推測*
- REQ-012: 「その意味」が空の場合、システムはインラインエラーメッセージを表示しなければならない 🟡 *requirements.md.pdf バリデーション要件 + ユーザヒアリングから推測*
- REQ-013: 「贈りたい言葉」が50文字を超える場合、システムは文字数制限エラーを表示しなければならない 🔵 *ユーザヒアリング2025-01-20 標準的なチェックより*
- REQ-014: 「その意味」が300文字を超える場合、システムは文字数制限エラーを表示しなければならない 🔵 *ユーザヒアリング2025-01-20 標準的なチェックより*
- REQ-015: バリデーションエラーが存在する場合、システムは送信ボタンを無効化しなければならない 🟡 *一般的なUXパターンから推測*

#### 制約要件

- REQ-021: システムは日本語（ひらがな、カタカナ、漢字）の入力に対応しなければならない 🔵 *CLAUDE.md 重要事項より*

### F-002: 共有リンク生成

#### 通常要件

- REQ-101: システムは送信ボタン押下時に一意のURLを生成しなければならない 🔵 *requirements.md.pdf 第2.2章より*
- REQ-102: システムはURLパラメータ形式で言葉と意味を含めなければならない 🔵 *requirements.md.pdf 第2.2章、CLAUDE.md実装詳細より*
- REQ-103: システムはBase64エンコードでURLを生成しなければならない 🔵 *CLAUDE.md URLパラメータ処理より*
- REQ-104: システムは生成されたURLをコピーできるボタンを提供しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- REQ-105: システムはURLコピー成功時にトーストメッセージを表示しなければならない 🔵 *ユーザヒアリング2025-01-20 エラー通知方法より*

#### 制約要件

- REQ-111: システムは生成されるURL全体の長さを500文字以内に制限しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- REQ-112: システムはURLエンコーディングにUTF-8を使用しなければならない 🟡 *一般的なWeb標準から推測*

### F-003: 贈る言葉表示ページ

#### 通常要件

- REQ-201: システムは武田鉄矢の画像を背景として表示しなければならない 🔵 *requirements.md.pdf 第2.3章より*
- REQ-202: システムは武田鉄矢の画像を右側〜中央に配置しなければならない 🔵 *requirements.md.pdf 第2.3章レイアウトより*
- REQ-203: システムは黒板の左側スペースに言葉と意味を縦書きで表示しなければならない 🔵 *requirements.md.pdf 第2.3章表示形式より*
- REQ-204: システムは辞書風のデザインで言葉を表示しなければならない 🔵 *requirements.md.pdf 第2.3章表示形式より*
- REQ-205: システムは1文字ずつタイプライターアニメーションで表示しなければならない 🔵 *requirements.md.pdf 第2.3章表示形式より*
- REQ-206: システムはトップページへ戻る「新しい言葉を贈る」ボタンを提供しなければならない 🔵 *ユーザヒアリング2025-01-20より*

#### 条件付き要件

- REQ-211: URLパラメータが不正な場合、システムはエラーページを表示しなければならない 🟡 *一般的なエラーハンドリングから推測*
- REQ-212: URLパラメータが存在しない場合、システムはトップページにリダイレクトしなければならない 🟡 *一般的なエラーハンドリングから推測*
- REQ-213: デコードに失敗した場合、システムは分かりやすいエラーメッセージを表示しなければならない 🟡 *ユーザヒアリング エラー通知から推測*

#### オプション要件

- REQ-221: システムはユーザーがクリックすることでタイプライターアニメーションをスキップできるようにしてもよい 🔵 *ユーザヒアリング2025-01-20 アニメ速度選択肢より*

#### 制約要件

- REQ-231: システムはタイプライターアニメーションの速度を100ms/文字に設定しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- REQ-232: システムは縦書きにCSS `writing-mode: vertical-rl` を使用しなければならない 🔵 *CLAUDE.md 実装詳細より*
- REQ-233: システムはチョーク風の色（`#f0f0f0`または`#fffacd`）でテキストを表示しなければならない 🔵 *CLAUDE.md デザイン要件より*

### F-004: 画像ダウンロード

#### 通常要件

- REQ-301: システムは画像保存ボタンを提供しなければならない 🔵 *requirements.md.pdf 第2.4章より*
- REQ-302: システムはボタンクリックで表示ページを画像化しなければならない 🔵 *requirements.md.pdf 第2.4章より*
- REQ-303: システムはhtml2canvasライブラリを使用して画像化しなければならない 🔵 *CLAUDE.md 画像エクスポート実装より*
- REQ-304: システムはPNG形式で画像を保存しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- REQ-305: システムは標準画質（デフォルト設定）で画像を保存しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- REQ-306: システムはファイル名を `gift-words-{YYYYMMDD}.png` 形式で保存しなければならない 🟡 *一般的なファイル命名規則から推測*

#### 条件付き要件

- REQ-311: 画像生成に失敗した場合、システムはトーストメッセージでエラーを通知しなければならない 🔵 *ユーザヒアリング2025-01-20 エラー通知方法より*

## 非機能要件

### パフォーマンス

- NFR-001: システムはページ読み込み時間を3秒以内に完了しなければならない 🔵 *requirements.md.pdf 第3.2章、tech-stack.mdより*
- NFR-002: システムはタイプライターアニメーションを60fps以上で動作させなければならない 🔵 *tech-stack.md パフォーマンス基準より*
- NFR-003: システムはバンドルサイズを500KB以下（gzip圧縮後）に抑えなければならない 🔵 *tech-stack.md パフォーマンス基準より*
- NFR-004: システムはLighthouseパフォーマンススコア90点以上を達成しなければならない 🔵 *tech-stack.md パフォーマンス基準より*

### セキュリティ

- NFR-101: システムはReactのデフォルトエスケープ機能でXSS攻撃を防止しなければならない 🔵 *tech-stack.md セキュリティ考慮事項より*
- NFR-102: システムは`dangerouslySetInnerHTML`を使用してはならない 🔵 *tech-stack.md セキュリティ考慮事項より*
- NFR-103: システムはユーザー入力を必ずサニタイズしなければならない 🔵 *tech-stack.md セキュリティ考慮事項より*
- NFR-104: システムはBase64エンコードでURLパラメータを基本的に難読化しなければならない 🔵 *tech-stack.md セキュリティ考慮事項より*

### ユーザビリティ

- NFR-201: システムはシンプルで直感的なUIを提供しなければならない 🔵 *requirements.md.pdf 第3.1章より*
- NFR-202: システムは入力から共有までの操作を3ステップ以内に完了できなければならない 🔵 *requirements.md.pdf 第3.1章より*
- NFR-203: システムはレスポンシブデザインでスマートフォンとデスクトップの両方に対応しなければならない 🔵 *requirements.md.pdf 第3.1章より*
- NFR-204: システ��はセマンティックHTMLで適切なHTML5要素を使用しなければならない 🔵 *tech-stack.md アクセシビリティより*
- NFR-205: システムは全機能をキーボードで操作可能にしなければならない 🔵 *tech-stack.md アクセシビリティより*
- NFR-206: システムは基本的なARIA属性を必要な箇所に適用しなければならない 🔵 *ユーザヒアリング2025-01-20 基本対応より*

### ブラウザ対応

- NFR-301: システムはChrome、Firefox、Edge、Safariの最新版に対応しなければならない 🔵 *requirements.md.pdf 第3.3章より*

### レスポンシブデザイン

- NFR-401: システムはモバイル横向き表示時にPC版と同じレイアウトで表示しなければならない 🔵 *ユーザヒアリング2025-01-20より*
- NFR-402: システムはモバイル縦向き表示時に適切に縮小またはスクロール対応しなければならない 🟡 *レスポンシブデザイン一般要件から推測*

## Edgeケース

### エラー処理

- EDGE-001: ネットワークエラー発生時、システムは分かりやすいエラーメッセージをトーストで表示しなければならない 🟡 *ユーザヒアリング エラー通知から推測*
- EDGE-002: ブラウザが古くhtml2canvasに対応していない場合、システムは代替手段または警告メッセージを表示しなければならない 🟡 *一般的なブラウザ互換性対応から推測*
- EDGE-003: クリップボードAPIが使用できない環境では、システムはURL選択状態にして手動コピーを促しなければならない 🟡 *一般的なクリップボードAPI対応から推測*

### 境界値

- EDGE-101: 言葉の文字数が0文字の場合、システムはバリデーションエラーを表示しなければならない 🔵 *requirements.md.pdf バリデーション + ユーザヒアリングより*
- EDGE-102: 言葉の文字数が50文字の場合、システムは正常に動作しなければならない 🔵 *ユーザヒアリング バリデーション要件より*
- EDGE-103: 言葉の文字数が51文字の場合、システムはバリデーションエラーを表示しなければならない 🔵 *ユーザヒアリング バリデーション要件より*
- EDGE-104: 意味の文字数が0文字の場合、システムはバリデーションエラーを表示しなければならない 🔵 *requirements.md.pdf バリデーション + ユーザヒアリングより*
- EDGE-105: 意味の文字数が300文字の場合、システムは正常に動作しなければならない 🔵 *ユーザヒアリング バリデーション要件より*
- EDGE-106: 意味の文字数が301文字の場合、システムはバリデーションエラーを表示しなければならない 🔵 *ユーザヒアリング バリデーション要件より*

### 特殊文字

- EDGE-201: 絵文字を含む入力の場合、システムは正常に表示しなければならない 🟡 *日本語対応要件から推測*
- EDGE-202: 改行を含む意味の入力の場合、システムは改行を保持して表示しなければならない 🟡 *複数行入力要件から推測*

## 制約事項

### 技術制約

- CONST-001: システムはバックエンドサーバーを持たないクライアントサイド専用アプリケーションである 🔵 *requirements.md.pdf 第5章、CLAUDE.mdより*
- CONST-002: システムはデータベースを使用しない 🔵 *requirements.md.pdf 第2.2章、tech-stack.mdより*
- CONST-003: システムのデータ永続化はURLパラメータのみで行う 🔵 *requirements.md.pdf 第2.2章より*

### 法的制約

- CONST-101: システムは武田鉄矢の画像について適切な著作権・肖像権を確認した上で使用する 🔵 *requirements.md.pdf 第9章、CLAUDE.md重要事項より*
- CONST-102: システムの利用規約にプライベート使用限定を明記する 🔵 *tech-stack.md セキュリティ考慮事項より*

### 運用制約

- CONST-201: システムはGitHub Pagesでホスティングされる 🔵 *tech-stack.md デプロイより*
- CONST-202: システムはGitHub Actions経由で自動デプロイされる 🔵 *tech-stack.md デプロイより*

## 将来の拡張可能性

以下は現バージョンのスコープ外だが、将来的に検討可能な機能：

- 複数のキャラクター選択（武田鉄矢以外）🔴
- 背景画像のカスタマイズ 🔴
- フォント・色のカスタマイズ 🔴
- SNS直接共有機能（Twitter/X、LINE等）🔴
- QRコード生成機能 🔴
- 過去に作成した言葉の履歴保存（ブラウザローカルストレージ）🔴
- 多言語対応（英語、中国語等）🔴

## 用語集

- **贈る言葉**: ユーザーが贈りたいオリジナルの言葉・単語
- **意味**: その言葉の意味・説明文
- **タイプライターアニメーション**: 1文字ずつ順番に表示される文字表示エフェクト
- **縦書き**: 日本語の伝統的な縦方向の文字配置
- **辞書風デザイン**: 辞書のような見出し語とその説明という体裁のデザイン
- **トーストメッセージ**: 画面の一部に短時間表示される通知メッセージ

## 更新履歴

- 2025-01-20: 初回作成（/tsumiki:kairo-requirementsにより生成）
